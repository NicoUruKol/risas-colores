/* ---------- ESCENA ---------- */
.sceneWrap{
  --header-h: 88px;
  display: grid;
  gap: 10px;
}

.scene{
  position: relative;
  width: 100%;
  overflow: hidden;
  border-radius: 18px;
  background: transparent;

  /* tamaño estable para el fit calculation */
  aspect-ratio: 3 / 2;
  height: auto;
  max-height: calc(100vh - var(--header-h) - 28px - 28px);
}

@media (min-width: 900px){
  .scene{
    height: min(
      640px,
      calc(100vh - var(--header-h) - 28px)
    );
  }
}

.layer{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: contain !important;
  object-position: center;
  user-select: none;
  pointer-events: none;
}

/* Hotspots */
.hotspot{
  position: absolute;
  background: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
  border-radius: 16px;
  outline: none;
  touch-action: manipulation;
}
.hotspot:focus-visible{
  outline: 2px solid rgba(74,144,194,.55);
  outline-offset: 2px;
}

/* Tooltip */
.tooltip{
  position: absolute;
  left: 12px;
  right: 12px;
  bottom: 12px;
  z-index: 85;
  background: rgba(255,255,255,.86);
  backdrop-filter: blur(10px);
  border-radius: 18px;
  padding: 12px 14px;
  box-shadow: 0 14px 34px rgba(0,0,0,.10);
}

.tooltipTitle{
  font-weight: 900;
  color: var(--ui-text);
  font-size: 13px;
}
.tooltipText{
  color: rgba(15, 23, 42, .72);
  margin-top: 2px;
  font-size: 13px;
}

/* Barra de tip debajo de la escena */
.tipBar{
  margin-top: 10px;
  padding: 10px 12px;
  border-radius: 14px;
  background: rgba(255,255,255,.75);
  backdrop-filter: blur(10px);
  box-shadow: 0 10px 26px rgba(0,0,0,.08);
  line-height: 1.25;
}

/* Texto */
.tipLabel{
  font-weight: 900;
  color: var(--ui-text);
  font-size: 13px;
}

.tipText{
  color: rgba(15, 23, 42, .72);
  font-size: 13px;
}

/* Si querés MÁS liviano todavía (sin caja), activá esto: */

.tipBar{
  background: none;
  box-shadow: none;
  padding: 0;
  margin-top: 8px;
  text-align: center;
}
.tipLabel{ display:none; }
.tipText{ color: var(--ui-muted); }

/* Ajuste mobile: subir el tooltip para que no cruce el sol */
@media (max-width: 640px){
  .tipBar{
    margin-top: 4px;          /* antes 10px */
    transform: translateY(-10px);
  }
}


/* ---------- CAPAS ANIMABLES (contenedores) ---------- */
.sun, .clouds, .birds, .tree, .kids, .ball, .magnifier, .house{
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 10;
}

.play{}

/* Sol */
.sun img:first-child{
  animation: none;
  transform-origin: var(--sun-cx) var(--sun-cy);
}

.sun.play img:first-child{
  animation: sunSpinClick 700ms ease-in-out 1;
}

@keyframes sunSpinClick{
  from{ transform: rotate(0deg); }
  to{ transform: rotate(360deg); }
}

/* Mantén tu “pop” si querés (opcional) */
.sun.play{
  animation: sunPop 450ms ease-out;
}

/* si no lo tenías definido en tu css, dejo uno suave y corto */
@keyframes sunPop{
  0%{ transform: scale(1); }
  45%{ transform: scale(1.03); }
  100%{ transform: scale(1); }
}

.sunFace{
  transform-origin: center;
}

/* rebote al click (cuando el sol está en play) */
.sun.play .sunFace{
  animation: sunFaceBounce 520ms ease-out 1;
}

@keyframes sunFaceBounce{
  0%   { transform: translateY(0) scale(1); }
  35%  { transform: translateY(-6px) scale(1.03); }
  70%  { transform: translateY(0) scale(0.99); }
  100% { transform: translateY(0) scale(1); }
}

/* Nubes */
.clouds.play{
  animation: cloudDrift 1000ms ease-in-out;
}
@keyframes cloudDrift{
  0%{ transform: translateX(0); }
  35%{ transform: translateX(25px); }
  65%{ transform: translateX(-25px); }
  100%{ transform: translateX(0); }
}



/* Pájaros + alas */
/* --- Pájaros (grupo) --- */
.birds{
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 10;
}

/* Movimiento del grupo completo (cuerpo+alas) */
.birds.play{
  animation: birdsFly 950ms ease-out 1;
}


.wingR{
  transform-origin: 59% 22%; 
  will-change: transform;
}

.wingL{
  transform-origin: 61% 19%; 
  will-change: transform;
}

/* Aleteo */
.birds.play .wingR{
  animation: flapR 500ms ease-in-out 0ms 3;
}
.birds.play .wingL{
  animation: flapL 500ms ease-in-out 30ms 3;
}

/* --- Keyframes --- */
@keyframes birdsFly{
  0%   { transform: translate(0,0); }
  60%  { transform: translate(16px,-10px); }
  100% { transform: translate(0,0); }
}

@keyframes flapR{
  0%   { transform: rotate(0deg); }
  50%  { transform: rotate(12deg); }
  100% { transform: rotate(0deg); }
}

@keyframes flapL{
  0%   { transform: rotate(0deg); }
  50%  { transform: rotate(-12deg); }
  100% { transform: rotate(0deg); }
}


/* Árbol hojas */
.treeLeaves{
  /* por defecto quietas */
  transform: translate3d(0,0,0);
  opacity: 1;
  will-change: transform, opacity;
}

/* Cuando tocás el árbol: loop de caída cortita + vaivén + fade */
.tree.play .treeLeaves{
  animation: leavesDriftFall 1200ms ease-in-out 1 forwards;
}

/* Caen “unos cm”, zigzag suave, se desvanecen y reinician arriba */
@keyframes leavesDriftFall{
  0%   { transform: translate3d(0px, 0px, 0);   opacity: 1; }
  20%  { transform: translate3d(10px, 8px, 0);  opacity: 1; }
  45%  { transform: translate3d(-10px, 16px, 0); opacity: .95; }
  70%  { transform: translate3d(8px, 24px, 0);  opacity: .7; }
  100% { transform: translate3d(0px, 32px, 0);  opacity: 0; }
}

/* Hamaca */
.hammock{
  transform-origin: var(--hammock-ox, 17%) var(--hammock-oy, 36%);
}

/* 1 ciclo por click */
.tree.play .hammock{
  animation: hammockSwing 1400ms ease-in-out 1;
}

@keyframes hammockSwing{
  0%   { transform: rotate(0deg); }
  20%  { transform: rotate(7deg); }
  45%  { transform: rotate(-6deg); }
  70%  { transform: rotate(4deg); }
  100% { transform: rotate(0deg); }
}


/* Niños */
.kids.play{
  animation: kidsPop 420ms ease-out;
}
/* Brazos: punto fijo */
.armR{
  transform-origin: 61% 79%; /* <- hombro brazo derecho (tuneo fino) */
}

.armL{
  transform-origin: 63% 78%; /* <- hombro brazo izquierdo (tuneo fino) */
}

/* Vaivén: rotación alternada, SIN translate */
.kids.play .armR{
  animation: armSwingR 900ms ease-in-out 1;
}

.kids.play .armL{
  animation: armSwingL 900ms ease-in-out 1;
}

@keyframes armSwingR{
  0%   { transform: rotate(0deg); }
  20%  { transform: rotate(-30deg); }
  40%  { transform: rotate(8deg); }
  60%  { transform: rotate(-30deg); }
  80%  { transform: rotate(8deg); }
  100% { transform: rotate(0deg); }
}

@keyframes armSwingL{
  0%   { transform: rotate(0deg); }
  20%  { transform: rotate(20deg); }
  40%  { transform: rotate(-15deg); }
  60%  { transform: rotate(10deg); }
  80%  { transform: rotate(-8deg); }
  100% { transform: rotate(0deg); }
}


/* Pelota */
.ball.play{
  animation: ballDownUp 500ms ease-in-out 1;
}

@keyframes ballDownUp{
  0%   { transform: translateY(0); }
  55%  { transform: translateY(24px); } /* ajustá “piso” */
  100% { transform: translateY(0); }
}


/* Lupa */
/* Lupa: pivot fijo tipo hombro */
.magnifier{
  transform-origin: 78% 80%; /* <- ajustá */
}

/* En vez de subir/bajar: rota hacia abajo y hace un micro vaivén */
.magnifier.play{
  animation: lupaAimDown 850ms ease-in-out 1;
}

@keyframes lupaAimDown{
  0%   { transform: rotate(0deg); }
  55%  { transform: rotate(-26deg); }  /* apunta abajo */
  75%  { transform: rotate(-18deg); }  /* acomoda */
  100% { transform: rotate(-24deg); }  /* queda abajo */
}



/* ✅ Casa/cartel: entra desde arriba + se acomoda con 2 movimientos laterales */
.house.play{
  animation: houseDropIn 2500ms cubic-bezier(.2,.9,.2,1) both;
}

@keyframes houseDropIn{
  /* cae desde arriba */
  0%   { transform: translateY(-70%) scale(.98); opacity: 0; }
  55%  { transform: translateY(0) scale(1);      opacity: 1; }

  /* “se acomoda” con 2 movimientos laterales */
  70%  { transform: translateX(10px); }
  82%  { transform: translateX(-8px); }
  92%  { transform: translateX(5px); }
  100% { transform: translateX(0); }
}


/* ====== OVERLAY DESBLOQUEO (blur + botón) ====== */
.unlockOverlay{
  pointer-events: auto;
  position: absolute;
  inset: 0;
  z-index: 120;
  display: grid;
  place-items: center;
  background: rgba(255,255,255,.35);
  backdrop-filter: blur(6px);
}

.unlockOverlay{
  animation: unlockFadeIn 300ms ease-out;
}

@keyframes unlockFadeIn{
  from{ opacity: 0; }
  to{ opacity: 1; }
}

.unlockCard{
  position: relative;
  width: min(360px, 92%);
  padding: 16px 14px;
  border-radius: 18px;
  background: rgba(255,255,255,.88);
  box-shadow: 0 18px 44px rgba(0,0,0,.14);
  display: grid;
  gap: 10px;
  text-align: center;
  z-index: 1;
}

.unlockTitle{
  font-weight: 900;
  color: var(--ui-text);
  font-size: 18px;
}
.unlockSubtitle{
  color: rgba(15, 23, 42, .72);
  font-size: 14px;
  margin-top: -6px;
}

.unlockClose{
  position: absolute;
  top: 8px;
  right: 10px;
  border: none;
  background: transparent;
  cursor: pointer;
  font-size: 16px;
  opacity: .7;
  z-index: 2;
  pointer-events: auto;
}
.unlockClose:hover{ opacity: 1; }

/* ✅ FIX: botón del overlay con buen contraste */
.unlockCard :global(button){
  background: var(--ui-primary, #4a90c2);
  color: #fff;
  border: 0;
  opacity: 1;
}

.unlockCard :global(button):hover{
  filter: brightness(.95);
}

.unlockCard :global(button):active{
  transform: translateY(1px);
}

/* por si tu Button renderiza un <a> dentro */
.unlockCard :global(a){
  color: inherit;
  text-decoration: none;
}
